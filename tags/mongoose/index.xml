<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Mongoose on Neal&#39;s Blog</title>
    <link>https://madneal.com/tags/mongoose/</link>
    <description>Recent content in Mongoose on Neal&#39;s Blog</description>
    <generator>Hugo</generator>
    <language>en</language>
    <copyright>© This post is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License，please give source if you wish to quote or reproduce.</copyright>
    <lastBuildDate>Sun, 17 Sep 2017 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://madneal.com/tags/mongoose/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Mongoose中document和object的区别</title>
      <link>https://madneal.com/post/mongoose%E4%B8%ADdocument%E5%92%8Cobject%E7%9A%84%E5%8C%BA%E5%88%AB/</link>
      <pubDate>Sun, 17 Sep 2017 00:00:00 +0000</pubDate>
      <guid>https://madneal.com/post/mongoose%E4%B8%ADdocument%E5%92%8Cobject%E7%9A%84%E5%8C%BA%E5%88%AB/</guid>
      <description>&lt;p&gt;这个问题其实是mongoose非常常见的问题，经常有很多以前没遇到这个问题的人都会被这个问题弄得怀疑人生。我们先介绍一些问题的背景。先看下面一段代码：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;router&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;get&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;function&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;req&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;res&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;next&lt;/span&gt;) {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#75715e&#34;&gt;// res.render(&amp;#39;index&amp;#39;, { title: &amp;#39;Express&amp;#39; });&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;model&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;mongoose&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;model&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;realestate&amp;#39;&lt;/span&gt;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;queryCretia&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {};&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  &lt;span style=&#34;color:#a6e22e&#34;&gt;model&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;find&lt;/span&gt;(&lt;span style=&#34;color:#a6e22e&#34;&gt;queryCretia&lt;/span&gt;, (&lt;span style=&#34;color:#a6e22e&#34;&gt;err&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;docs&lt;/span&gt;) =&amp;gt; {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    &lt;span style=&#34;color:#a6e22e&#34;&gt;res&lt;/span&gt;.&lt;span style=&#34;color:#a6e22e&#34;&gt;render&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;index&amp;#39;&lt;/span&gt;, {&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;title&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;express&amp;#39;&lt;/span&gt;,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;      &lt;span style=&#34;color:#a6e22e&#34;&gt;docs&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;docs&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;    })&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;  })&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;});&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code class=&#34;language-ejs&#34; data-lang=&#34;ejs&#34;&gt;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html&amp;gt;&#xA;  &amp;lt;head&amp;gt;&#xA;    &amp;lt;title&amp;gt;&amp;lt;%= title %&amp;gt;&amp;lt;/title&amp;gt;&#xA;    &amp;lt;link rel=&amp;#39;stylesheet&amp;#39; href=&amp;#39;/stylesheets/style.css&amp;#39; /&amp;gt;&#xA;  &amp;lt;/head&amp;gt;&#xA;  &amp;lt;body&amp;gt;&#xA;    &amp;lt;h1&amp;gt;&amp;lt;%= title %&amp;gt;&amp;lt;/h1&amp;gt;&#xA;    &amp;lt;p&amp;gt;Welcome to &amp;lt;%= title %&amp;gt;&amp;lt;/p&amp;gt;&#xA;    &amp;lt;!-- &amp;lt;%= docs %&amp;gt; --&amp;gt;&#xA;    &amp;lt;ul&amp;gt;&#xA;      &amp;lt;% docs.forEach(function(doc){ %&amp;gt;&#xA;      &amp;lt;li&amp;gt;&amp;lt;%= doc.type %&amp;gt;&amp;lt;/li&amp;gt;&#xA;      &amp;lt;% }) %&amp;gt;&#xA;    &amp;lt;/ul&amp;gt;&#xA;  &amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在第一段代码中，通过&lt;code&gt;model.find&lt;/code&gt;我们应该能够获取到根据&lt;code&gt;queryCriteria&lt;/code&gt;获取的结果，结果应该是一个对象数组，类似于这样：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[{&#xA;    &amp;#34;_id&amp;#34; : ObjectId(&amp;#34;59bdeadb2a5c612514ee7970&amp;#34;),&#xA;    &amp;#34;title&amp;#34; : &amp;#34;好楼层，中等装修，满5年，上门实拍&amp;#34;,&#xA;    &amp;#34;type&amp;#34; : &amp;#34;2室1厅&amp;#34;,&#xA;    &amp;#34;square&amp;#34; : &amp;#34;75.42平&amp;#34;,&#xA;    &amp;#34;direction&amp;#34; : &amp;#34;朝南&amp;#34;,&#xA;    &amp;#34;floor&amp;#34; : &amp;#34;中区/6层&amp;#34;,&#xA;    &amp;#34;unitPrice&amp;#34; : 47732,&#xA;    &amp;#34;totalPrice&amp;#34; : 360,&#xA;    &amp;#34;location&amp;#34; : null,&#xA;    &amp;#34;specialExplain&amp;#34; : &amp;#34;满五&amp;#34;,&#xA;    &amp;#34;url&amp;#34; : &amp;#34;http://sh.lianjia.com//ershoufang/sh4528035.html&amp;#34;,&#xA;    &amp;#34;station&amp;#34; : &amp;#34;江杨北路&amp;#34;,&#xA;    &amp;#34;line&amp;#34; : &amp;#34;3号线&amp;#34;,&#xA;    &amp;#34;updateTime&amp;#34; : &amp;#34;2017-09-17 11:24:11&amp;#34;&#xA;}&#xA;{&#xA;    &amp;#34;_id&amp;#34; : ObjectId(&amp;#34;59bdeadb2a5c612514ee7971&amp;#34;),&#xA;    &amp;#34;title&amp;#34; : &amp;#34;南北户型，厨卫全明，高区采光好，装修精美&amp;#34;,&#xA;    &amp;#34;type&amp;#34; : &amp;#34;2室2厅&amp;#34;,&#xA;    &amp;#34;square&amp;#34; : &amp;#34;90.92平&amp;#34;,&#xA;    &amp;#34;direction&amp;#34; : &amp;#34;朝南北&amp;#34;,&#xA;    &amp;#34;floor&amp;#34; : &amp;#34;高区/6层&amp;#34;,&#xA;    &amp;#34;unitPrice&amp;#34; : 46194,&#xA;    &amp;#34;totalPrice&amp;#34; : 420,&#xA;    &amp;#34;location&amp;#34; : null,&#xA;    &amp;#34;specialExplain&amp;#34; : &amp;#34;满五&amp;#34;,&#xA;    &amp;#34;url&amp;#34; : &amp;#34;http://sh.lianjia.com//ershoufang/sh4546221.html&amp;#34;,&#xA;    &amp;#34;station&amp;#34; : &amp;#34;江杨北路&amp;#34;,&#xA;    &amp;#34;line&amp;#34; : &amp;#34;3号线&amp;#34;,&#xA;    &amp;#34;updateTime&amp;#34; : &amp;#34;2017-09-17 11:24:11&amp;#34;&#xA;}]&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;预期&lt;code&gt;index.ejs&lt;/code&gt;应该渲染的页面是一个ul渲染的结果，类似于&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
